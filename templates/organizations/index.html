{% extends "organizations/organizations-base.html" %}

{% block src-javascript %}
{% load static %}
<script type="text/javascript" src="{% static 'js/organizations/submit.js' %}"></script>
z<script type="text/javascript" src="{% static 'js/organizations/organizations.js' %}"></script>

<!-- Template for organization list -->
<script id="org_list_template" type="text/template">
<tr>
    <td>
        <a href="/home">
            <%- name %>
        </a>
    </td>
    <td><%= signator %></td>
    <td>
        <a href="mailto:<%- email %>" target="_top">
            <%- email %>
        </a>
    </td>
</tr>
</script>
{% endblock %}

{% block content %}
  <div class="row-extra-padding">
    <div class="col-md-5">
    	<h2 class="featurette-heading">
      		Welcome to the Organization Manager.
      	</h2>
	  	<p class="lead">
  			<span class="text-muted">
			Our latest intelligence shows that you
			{% if user.attended_signator_training %}
	  		have
			{% else %}
	  		have not
			{% endif %}
			attended signator training.
  			</span>
    </div> <!-- /. col-md-7 ... -->
    <div class="col-md-7">


	{% if user.attended_signator_training %}

        <div class="panel panel-default">
            <div class="panel-body">
	        <h2>My Organizations</h2>

                
                <table class="table table-hover">
                    <tr>
                        <th>Name</th>
                        <th>Registered for Funding Poll</th>
                        <th colspan=3>Actions</th>

                    </tr>
                    {% for o in organizations %}
                    <tr>
                        <td>
                            <a href="{% url 'organizations.views.organization_detail' o.id %}">
                                {{ o.name }}
                            </a>
                        </td>
                        <td>
                            {% if o.reg_for_fp %}
                            <span class="glyphicon glyphicon-ok" aria-hidden="true"></span>
                            {% endif %}
                        </td>
                        <td>
                            <a type="button" class="btn btn-default"
                               href="{% url 'organizations.views.edit_org' o.id %}">
                                <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
                                Edit
                            </a>
                        </td>
                        <td>
                            <a type="submit" class="btn btn-default"
                               href="{% url 'organizations.views.change_signator_get' o.id %}">
                                <span class="glyphicon glyphicon-sort" aria-hidden="true"></span>
                                Swap Signator
                            </a>
                        </td>
                        <td>
                            <form method="post"
                                  action="{% url 'organizations.views.delete_org' o.id %}">
                                {% csrf_token %}
                                <button type="submit" class="btn btn-default btn-danger">
                                    <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
                                    Delete
                                </button>
                            </form>
                        </td>
                    </tr>
                    {% endfor %}
                    <tr>
                        <td colspan=5><a
		              href="{% url 'orgs-edit' '' %}">
	                        Create an Organization &raquo;
	                </td>
                    </tr>
                </table>
            </div>
        </div>
	{% else %}
        <p>
	You are sadly unable to create and maintain organizations
	at the moment. Please contact Finance Committee for more information.
	{% endif %}
        </p>

        <!-- Org table -->
        <h2>All Student Body Organizations</h2>
        <form id="org_list_search"
              method="post"
              action="{% url 'generic.api.search_orgs' %}">
            {% csrf_token %}
            <div class="input-group">
                <input id="org_list_search_query"
                       type="text" class="form-control"
                       placeholder="Organization name or signator name">
                <span class="input-group-btn">
                    <input class="btn btn-primary" type="submit">
                </span>
            </div>
        </form>
        
        <table class="table table-hover">
            <thead>
            <tr>
                <th>Name</th>
                <th>Signator</th>
                <th>Email</th>
            </tr>
            </thead>
            <tbody id="org-table-container">

            </span>
        </table>

        
        </div>
      </div>
</div> <!--/.container -->
{% endblock %}
